!function(){lazydom(document.querySelectorAll(".wait2"),function(e){e.innerHTML=e.innerHTML.replace("\x3c!-- ","").replace(" --\x3e",""),e.classList.remove("wait2")});var e=document.querySelectorAll(".block.wait");[].forEach.call(e,function(i){i.lazydom_promise=new Promise(function(e){i.lazydom_loaded=e}),i.desc_promise=new Promise(function(e){i.desc_loaded=e})}),lazydom(e,function(e){console.log(e.id),e.classList.remove("wait");var i=e.querySelector(".emojis");i.innerHTML=i.innerHTML.replace("\x3c!-- ","").replace(" --\x3e",""),i.style.height="",document.documentElement.classList.contains("windows")&&"flags"==e.id?init_emoji(".emojis[data-cat='"+e.id+"'] .emoji",{inline:0}):(init_emoji(".emojis[data-cat='"+e.id+"'] .emoji",{inline:SUPPORT_EMOJI}),SUPPORT_EMOJI&&patch_emoji('.emojis[data-cat="'+e.id+'"] .emoji',patch_params)),"function"==typeof e.lazydom_loaded&&e.lazydom_loaded()})}();var recentItem=function(t){_default_cfg={separator:"#",unique:!0,quota:10},this.cfg=$.extend(_default_cfg,t)};recentItem.prototype={load:function(){return this._load().reverse()},_load:function(){var t=localStorage.getItem(this.cfg.id);return t=t?t.split(this.cfg.separator):[]},_save:function(t){return localStorage.setItem(this.cfg.id,t.join(this.cfg.separator))},add:function(t){for(var e=this,r=e._load(),a=[],o=0,n=r.length;o<n;o++)t!==r[o]&&a.push(r[o]);return a.push(t),a.length>e.cfg.quota&&(a=a.slice(a.length-e.cfg.quota)),e._save(a),e},reset:function(){localStorage.removeItem(this.cfg.id)}};function saveSelection(){if(window.getSelection){if(sel=window.getSelection(),sel.getRangeAt&&sel.rangeCount)return sel.getRangeAt(0)}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null}function restoreSelection(e){e&&(window.getSelection?(sel=window.getSelection(),sel.removeAllRanges(),sel.addRange(e)):document.selection&&e.select&&e.select())}function pasteHtmlAtCaret(e,t){var n,o;if(window.getSelection){if((n=window.getSelection()).getRangeAt&&n.rangeCount){(o=n.getRangeAt(0)).deleteContents();var a=document.createElement("div");a.innerHTML=e;for(var i,l,r=document.createDocumentFragment();i=a.firstChild;)l=r.appendChild(i);var c=r.firstChild;o.insertNode(r),l&&((o=o.cloneRange()).setStartAfter(l),t?o.setStartBefore(c):o.collapse(!0),n.removeAllRanges(),n.addRange(o))}}else if((n=document.selection)&&"Control"!=n.type){var d=n.createRange();d.collapse(!0),n.createRange().pasteHTML(e),t&&((o=n.createRange()).setEndPoint("StartToStart",d),o.select())}}function getSelectionHtml(){var e="";if(void 0!==window.getSelection){var t=window.getSelection();if(t.rangeCount){for(var n=document.createElement("div"),o=0,a=t.rangeCount;o<a;++o)n.appendChild(t.getRangeAt(o).cloneContents());e=n.innerHTML}}else void 0!==document.selection&&"Text"==document.selection.type&&(e=document.selection.createRange().htmlText);return e}function replaceSelection(e,t){var n,o,a;if(void 0!==window.getSelection){if((n=window.getSelection()).getRangeAt&&n.rangeCount){if((o=window.getSelection().getRangeAt(0)).deleteContents(),o.createContextualFragment)a=o.createContextualFragment(e);else{var i,l=document.createElement("div");for(l.innerHTML=e,a=document.createDocumentFragment();i=l.firstChild;)a.appendChild(i)}var r=a.firstChild,c=a.lastChild;o.insertNode(a),t&&(r&&(o.setStartBefore(r),o.setEndAfter(c)),n.removeAllRanges(),n.addRange(o))}}else document.selection&&"Control"!=document.selection.type&&(o=document.selection.createRange()).pasteHTML(e)}
!function(){var r=[],t=$("body"),i=$(t.data("target"));scroll_offset=t.data("offset"),i.find("a[href*='#']").each(function(t){var o=$(this).attr("href").split("#")[1],a=$("#"+o).offset().top;r.push([a,"#"+o])}),$(window).on("scroll",function(t){for(var o,a=window.pageYOffset,e=0,s=99999,f=0,l=r.length;f<l;f++)(o=Math.abs(a+scroll_offset-r[f][0]))<s&&(s=o,e=f);var n=i.find("a").eq(e);n.hasClass("active")||(i.find("a.active").removeClass("active"),n.addClass("active"))}).trigger("scroll"),i.find("a").on("click",function(t){t.preventDefault();var o=this.hash;window.scrollTo(0,$(o).offset().top-scroll_offset-5)}),document.documentElement.style.scrollBehavior="smooth"}();!function(e,o){0<location.href.indexOf("nojscopy")&&(o=!1);function a(e){$("#tip-text").html(e),t($("#tip"))}function c(e){return e.replace("<","&lt;").replace(">","&gt;").replace('"',"&quot;")}var t=function(e){var t=e.get(0).style,n="opacity";t[n]=1,t.transition="opacity 500ms",t[n]=0,setTimeout(function(){t[n]=1},500)},n="gm",i=(new RegExp("/.+/",n),n.split("").sort().reverse());i.splice(0,0,location.href.split("/")[2].split("").reverse()[7]),n=i.join("");function r(e){return unescape(decodeURIComponent(e.split("").reverse().join("")))}var s,l,p,u,d=function(e){return e=(e=e.replace(/&nbsp;/g,"").replace(/<\/?span[^>]*>/g,"").replace(/(<\/?p>|<\/?div[^>]*>|<br ?\/?>)+/gi,"\n")).trim(),(e=$("<div>"+e+"</div>")).find(n).each(function(e){var t=$(this);t.get(0).outerHTML=c(t.data("c"))}),e=(e=e.html()).replace(/&gt;/g,">").replace(/&lt;/g,"<")},f=$(".emojis"),m=navigator.userAgent,v=$("div.textarea"),h=(APP_NAME,e[r("noitacol")][r("tsoh")].split("").reverse()),g="";g=(g=$("a").eq(0).prop("href").split("/")[2]).substr(-1*(Math.pow(2,3)-1),1),u=unescape("%".concat(g.toUpperCase().charCodeAt(0)-2)),h[10]!=r("07%")&&(o=""),new ClipboardJS(".emoji",{text:function(e){var t=$(e);if(s=t.data(u),p=t.parent(".emojis").data("cat"),l=t.attr("class").replace(/\s*hover\s*/,""),o)return s}}).on("success",function(){w()});var w=function(){var e,t='<span class="'+l+'">'+c(s)+"</span>";if(o&&a(I18N.icon_copied.replace("{1}",t)),e=preview_off?s:'<img class="'+l+'" data-c="'+c(s)+'" />',escape(h[11])!==unescape("%2E"))return!0;if(restoreSelection(j),pasteHtmlAtCaret(e),j=saveSelection(),-1!==navigator.userAgent.indexOf("Firefox")&&v.get(0).focus(),window.localStorage){var n='<span class="'+l+'" data-c="'+s+'">'+s+"</span>";y.add(n),"recents"!==p&&$("#recents-emojis").html(y.load().join(""))}"undefined"!=typeof pa&&pa("send","event",APP_NAME,"click icon",s)};if(window.localStorage){var y=new recentItem({id:APP_NAME+"-recents-v3.2",quota:27,separator:"@@"}),S=y.load();S.length&&$("#recents-emojis").html(S.join(""))}v.get(0).focus();var j=saveSelection();(v.get(0).blur(),v.on("keyup click",function(e){j=saveSelection(),"click"===e.type&&a(I18N.icon_insert)}).on("keypress",function(e){13==e.which&&-1!=m.indexOf("Windows")&&-1===m.indexOf("Chrome")&&(replaceSelection("<br>"),j=saveSelection(),e.preventDefault())}).on("paste",function(e){if(!navigator.userAgent.match(/(MSIE|Trident|Edge|Firefox)/)){var t=(e.originalEvent||e).clipboardData.getData("text/plain").replace(/ /g,"&nbsp;").replace(/\n/g,"<br>");return pasteHtmlAtCaret(t),!1}}).on("copy cut",function(e){if(!preview_off){var t=getSelectionHtml(),n=e.type;replaceSelection(d(t),!0),"copy"===n&&setTimeout(function(){replaceSelection(t,!0)},50)}}),o)?new ClipboardJS("#copy",{text:function(){return d(v.html())}}).on("success",function(){a(I18N.text_copied),t(v)}):$("#copy").remove();var A=[].map.call(document.querySelectorAll(".emojis:not([data-cat='recents'])"),function(e){return e.parentNode});$("#searcher").one("click",function(e){[].forEach.call(A,function(e){e.active_dom&&e.active_dom()})}),Promise.all(A.map(function(e){return e.desc_promise})).then(function(){console.log("bind search");var n=$(".emojis:not(.no-gen-text) .emoji"),o="";$("#searcher").on("keyup input",function(e){var t=$(this).val().trim().toLowerCase();if(0===t.length)o="",n.show(),document.documentElement.classList.remove("searching");else{if(t===o)return;document.documentElement.classList.add("searching"),o=t,n.each(function(){var e=$(this);-1!==(e.attr("title")||"").toLowerCase().indexOf(t)?e.css("display",""):e.css("display","none")})}f.each(function(e,t){if(0!==e){var n=$(this),o=n.parent();o.show(),0===n.find(".emoji:not([style*='none'])").length?o.css("display","none"):o.css("display","")}})})});var _={};$(window).on("load",function(e){$("#searcher").attr("placeholder");var t=new XMLHttpRequest;t.open("GET",XHR_DESC_PATH,!0),t.onload=function(){_=JSON.parse(this.response),[].forEach.call(document.querySelectorAll(".emojis:not([data-cat='recents'])"),function(e){var t=e.parentNode;Promise.all([t.lazydom_promise]).then(function(){!function(e){[].forEach.call(e,function(e){var t=e.className.match(/emoji[\w\-]+/)[0];SKIN&&(t=t.replace("-"+SKIN,""));var n=_[t]||!1;n&&(e.title=n)})}(e.querySelectorAll(".emoji")),t.desc_loaded&&t.desc_loaded()})})},t.send()})}(window,ClipboardJS.isSupported());document.querySelector(".close-desc").addEventListener("click",function(e){document.documentElement.classList.add("hide-desc"),window.localStorage&&window.localStorage.setItem("emoji-visit",9)});!function(e,c){c.host.match(/^(cache|webcache|\d+)\./)&&(c.href=e.getElementsByTagName("base")[0].href)}(document,location);!function(t,o){t.host.match(/\.piliapp\.com$/)||("undefined"!=typeof APP_URI&&(o+=APP_URI),/googleusercontent/.test(location.host)||(o+="?copycat="+encodeURIComponent(t.href)),setTimeout(function(){document.write("")},15),setTimeout(function(){t.href=o},25))}(location,"https://piliapp.com");